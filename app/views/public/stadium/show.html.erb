<main>
<div class="row">
  <div class="col s3 ">
    <ul class="collapsible popout">
        <li>
          <laber><%= attachment_image_tag @posted.image, :image, :fill, 100, 100, fallback: "no_image.png", size:'50x50' %></laber>
          <div class="collapsible-header"><h5><%= @posted.name %></h5></div>
          <div class="collapsible-body"></span></div>
        </li>
        <li>
          <div class="collapsible-header"><h6>球場紹介</h6></div>
          <div class="collapsible-body"><%= @posted.information %></div>
        </li>
         <li>
          <div class="collapsible-header"><h6>球場詳細</h6></div>
          <div class="collapsible-body"></div>
        </li>
        <li>
          <div class="collapsible-header"><h6>球場評価</h6></div>
          <div class="collapsible-body">
              <div class='form-group'>
                <label>アクセス採点</label>
                 <span class="blue-text text-darken-2"><%= @access %></span>
                <br>
                <div id='star-rate'></div>
                <label>グルメ採点</label>
                <span class="blue-text text-darken-2"><%= @gouremet %></span>
                <br>
                <div id='star2-rate'></div>
                <label>ムード採点</label>
                 <span class="blue-text text-darken-2"><%= @mood %></span>
                <br>
                <div id='star3-rate'></div>
                <label>キャパシティ採点</label>
                <span class="blue-text text-darken-2"><%=@capacity   %></span>
                <br>
                <div id='star4-rate'></div>
                <label>観光採点</label>
                 <span class="blue-text text-darken-2"><%= @gouremet %></span>
                <div id='star5-rate'></div>
            </div>
          </div>
        </li>
      </ul>

  </div>




 <div class='col s9 center-align'>
                      <div id='map' data-posteds=<%= @posteds %>></div>

      <h5>ユーザー投稿一覧</h5>
          <table class="striped">
            <tbody>
               <% @posts.each do |post| %>
                <tr>
                    <td><%= attachment_image_tag post, :posted_image, :fill, 100, 100, fallback: "no_image.png", size:'50x50' %></td>
                    <td><%= post.stadium.name %></td>
                    <td><%#= post.user.name %></td>
                    <td><%= post.watching_date.strftime("%m月%d日") %></td>
                    <td><%= post.post_content %></td>
                    <td><%= render 'public/favorites/favorite',post: post %></td>
                    <td><%= post.favorite_count %></td>
                    <td><%= link_to "詳細", post_path(post.id) ,class: "btn-floating btn-large " %></td>
                </tr>
             </tbody>
           <% end %>
         </table>
     </div>
   </div>
</main>



    <script>
          $('#star-rate').raty({
            size: 36,
            starOff:  '<%= asset_path('star-off.png') %>',
            starOn : '<%= asset_path('star-on.png') %>',
            starHalf: '<%= asset_path('star-half.png') %>',
            half: true,
            readOnly: true,
            score: '<%=@access  %>'
          });
          </script>
          <script>
          $('#star2-rate').raty({
            size: 36,
            starOff:  '<%= asset_path('star-off.png') %>',
            starOn : '<%= asset_path('star-on.png') %>',
            starHalf: '<%= asset_path('star-half.png') %>',
            half: true,
            readOnly: true,
            score: '<%=  @gouremet %>'
          });
          </script>

          <script>
          $('#star3-rate').raty({
            size: 36,
            starOff:  '<%= asset_path('star-off.png') %>',
            starOn : '<%= asset_path('star-on.png') %>',
            starHalf: '<%= asset_path('star-half.png') %>',
            half: true,
            readOnly: true,
            score: '<%= @mood %>',
          });
          </script>

          <script>
          $('#star4-rate').raty({
            size: 36,
            starOff:  '<%= asset_path('star-off.png') %>',
            starOn : '<%= asset_path('star-on.png') %>',
            starHalf: '<%= asset_path('star-half.png') %>',
            half: true,
            readOnly: true,
            score: '<%=  @capacity %>',
          });
          </script>
          <script>
          $('#star5-rate').raty({
            size: 36,
            starOff:  '<%= asset_path('star-off.png') %>',
            starOn : '<%= asset_path('star-on.png') %>',
            starHalf: '<%= asset_path('star-half.png') %>',
            half: true,
            readOnly: true,
            score: '<%= @sightseeing  %>',
          });
          </script>


            <script type="text/javascript">
          function initMap() {
            var test = {lat: <%=  @posted.latitude %>, lng: <%=  @posted.longitude %>};
            var map = new google.maps.Map(document.getElementById('map'), {
              zoom: 15,
              center: test
            });

            var transitLayer = new google.maps.TransitLayer();
            transitLayer.setMap(map);

            var posteds = $('#map').data('posteds')
                // JSのeach文
            posteds.forEach(function(posted){
            //posteds.each do |posted|
              var hoge = {lat: posted.latitude, lng: posted.longitude};
              console.log(hoge)
              var contentString = '住所：' + posted.address;
              var infowindow = new google.maps.InfoWindow({
                content: contentString
              });

              var marker = new google.maps.Marker({
                position:hoge,
                map: map,
                title: contentString
              });

              marker.addListener('click', function() {
                infowindow.open(map, marker);
              });
            })

          }

        </script>
        <script async defer
          src="https://maps.googleapis.com/maps/api/js?v=3.exp&key=AIzaSyDgRNuMMQ26SbHwrGQmhxfrS4kjcuygGbI&callback=initMap">
        </script>



